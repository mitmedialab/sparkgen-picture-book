webpackJsonp([1],{"40b6":function(e,t){},"4VNO":function(e,t){},"4zu3":function(e,t){},"6bff":function(e,t){},"90S9":function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("7+uW"),n=s("fZjL"),r=s.n(n),i={name:"App",beforeCreate:function(){this.$store.state.alerts={}},created:function(){0===r()(this.$store.state.pages).length&&this.$store.commit("createPage")}},o={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var c=s("VU/8")(i,o,!1,function(e){s("90S9")},null,null).exports,u=s("/ocq"),l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",[""!=e.$store.state.username?s("section",{staticClass:"title-area"},[e.editing||""==e.$store.state.currentTitle?s("textarea",{staticClass:"title-content",domProps:{value:e.draft},on:{input:function(t){e.draft=t.target.value}}}):e._e(),e._v(" "),e.editing||""===e.$store.state.currentTitle?e._e():s("h1",{staticClass:"title-font"},[e._v("\n            "+e._s(this.$store.state.currentTitle)+"\n        ")]),e._v(" "),e.editing||""==e.$store.state.currentTitle?s("button",{staticClass:"title-button button-74",on:{click:e.addTitle}},[e._v("Save Title\n        ")]):e._e(),e._v(" "),e.editing||""===e.$store.state.currentTitle?e._e():s("button",{staticClass:"edit-button button-74",on:{click:e.editTitle}},[e._v("Edit Title\n        ")])]):e._e(),e._v(" "),""==e.$store.state.username?s("section",{staticClass:"title-area"},[s("textarea",{staticClass:"title-content",domProps:{value:e.nameDraft},on:{input:function(t){e.nameDraft=t.target.value}}}),e._v(" "),s("button",{staticClass:"title-button button-74",on:{click:e.addUsername}},[e._v("Enter in username\n        ")])]):e._e()])},staticRenderFns:[]};var g=s("VU/8")({name:"TitleForm",data:function(){return{draft:this.$store.state.currentTitle,nameDraft:"",alerts:{},editing:!1}},methods:{addTitle:function(){/^[A-Za-z0-9\s\-_,\.;:()]+$/.test(this.draft)&&this.draft.length<=140?(this.$store.commit("changeTitle",this.draft),this.editing=!1):this.$store.commit("alert",{message:"Invalid title inputted",status:"error"})},editTitle:function(){this.editing=!0},addUsername:function(){/^[a-zA-Z0-9]([._-](?![._-])|[a-zA-Z0-9]){3,18}[a-zA-Z0-9]$/.test(this.nameDraft)?this.$store.commit("addUsername",this.nameDraft):this.$store.commit("alert",{message:"Invalid username",status:"error"})}}},l,!1,function(e){s("4zu3")},"data-v-f49b651a",null).exports,m=s("Xxa5"),p=s.n(m),d=s("exGp"),h=s.n(d),f=s("mvHQ"),v=s.n(f),_={name:"SentenceForm",data:function(){return{draft:this.$store.state.currentSentence,alerts:{},constantPre:"This is a story about "+this.$store.state.currentTitle+". Write one more sentence of the story. The following is the most recent sentence of the story: ",sentences:["This is the first page of the story, so there is no suggested sentence."],previousSentence:"This is a story about "+this.$store.state.currentTitle}},props:{pageNum:{type:Number,required:!1}},watch:{"$store.state.pageCount":function(){this.draft=""},"$store.state.currentSentence":function(){this.draft=this.$store.state.currentSentence},pageNum:function(e){1!==e&&0===this.$store.state.pages[e].generatedSentences.length?(this.previousSentence=this.$store.state.pages[e-1].caption,this.previousSentence=this.constantPre+this.previousSentence,this.generateSentence()):this.sentences=1===e?["This is the first page of the story, so there is no suggested sentence."]:this.$store.state.pages[e].generatedSentences}},methods:{addSentence:function(){if(/[A-Za-z0-9 _.,!\"\'\/$]+/.test(this.draft)&&this.draft.length<=140)this.$store.commit("changeSentence",{pageNum:this.pageNum,sentence:this.draft}),this.$emit("sentenceEdited",!0);else{this.$store.commit("alert",{message:"Invalid sentence inputted",status:"error"})}},generateSentence:function(){var e={method:"POST",message:"Successfully added generated sentences",body:v()({model:"text-davinci-003",prompt:this.previousSentence,temperature:.7,max_tokens:96,top_p:1,n:3,frequency_penalty:0,presence_penalty:.3})};this.request(e)},request:function(e){var t=this;return h()(p.a.mark(function s(){var a,n,r,i,o;return p.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a={method:e.method,headers:{"Content-Type":"application/json",Authorization:"Bearer "+Object({NODE_ENV:"production",BASE_URL:"/sparkgen-picture-book/"}).VUE_APP_OPENAI_KEY}},e.body&&(a.body=e.body),s.prev=2,s.next=5,fetch("https://api.openai.com/v1/completions",a);case 5:if((n=s.sent).ok){s.next=11;break}return s.next=9,n.json();case 9:throw r=s.sent,new Error(r.error);case 11:return s.next=13,n.json();case 13:i=s.sent,t.sentences=i.choices.map(function(e){return e.text}),t.$store.commit("refreshGeneratedSentence",{pageNum:t.pageNum,sentences:t.sentences}),s.next=22;break;case 18:s.prev=18,s.t0=s.catch(2),o="There was an error fetching suggested sentences",t.$store.commit("alert",{message:o,status:"error"});case 22:case"end":return s.stop()}},s,t,[[2,18]])}))()}}},b={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",[s("section",{staticClass:"title-area"},[s("textarea",{staticClass:"sentence-content",domProps:{value:e.draft},on:{input:function(t){e.draft=t.target.value}}}),e._v(" "),s("button",{staticClass:"sentence-button button-74",on:{click:e.addSentence}},[e._v("Save Sentence & Generate Image")])]),e._v(" "),s("section",[s("p",[e._v("Suggested sentences:")]),e._v(" "),e._l(e.sentences,function(t,a){return s("p",{key:a},[e._v("\n            "+e._s(t)+"\n        ")])})],2)])},staticRenderFns:[]};var x=s("VU/8")(_,b,!1,function(e){s("u/Tk")},null,null).exports,$={name:"PageComponent",props:{pageNumber:{type:Number,required:!0},active:{type:Boolean,required:!0},selectedImage:{type:Number,required:!0}},watch:{active:function(e){var t=document.getElementById("box-"+this.pageNumber);this.active?(t.style.transform="translateY(-15px)",t.style.boxShadow="rgba(0, 0, 0, 0.2) 0 4px 12px"):(t.style.transform="translateY(0px)",t.style.boxShadow="rgba(0, 0, 0, 0) 0 4px 12px")}},mounted:function(){if(this.active){var e=document.getElementById(this.pageNumber);e.style.transform="translateY(-15px)",e.style.boxShadow="rgba(0, 0, 0, 0.2) 0 4px 12px"}},data:function(){return{alerts:{}}},methods:{boxClicked:function(){this.$emit("boxClicked",this.pageNumber)}}},C={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("article",[s("div",{staticClass:"page-box",attrs:{id:"box-"+e.pageNumber},on:{click:e.boxClicked}},[e.selectedImage>-1?s("div",{staticClass:"box-content"},[s("div",{staticClass:"picture-box"},[s("img",{staticClass:"picture-box regular-image",attrs:{src:"data:image/jpeg;base64,"+e.$store.state.pages[e.pageNumber].allImages[e.$store.state.pages[e.pageNumber].selectedImage]}})]),e._v(" "),s("h1",{staticClass:"box-text"},[e._v("\n                "+e._s(e.$store.state.pages[e.pageNumber].caption)+"\n            ")])]):e._e()])])},staticRenderFns:[]};var y=s("VU/8")($,C,!1,function(e){s("aHjL")},"data-v-186be1a4",null).exports,N={name:"PictureDisplay",props:{pageNum:{type:Number,required:!1},changeCount:{type:Number,required:!0}},data:function(){return{selected:[!1,!1,!1,!1],images:this.$store.state.pages[this.pageNum].allImages?this.$store.state.pages[this.pageNum].allImages:[],loading:!1,alerts:{}}},watch:{changeCount:function(){""!==this.$store.state.currentSentence?(this.generateImages(),this.loading=!0):this.images=this.$store.state.pages[this.pageNum].allImages},pageNum:function(e){this.images=this.$store.state.pages[e].allImages,this.selected=[!1,!1,!1,!1],this.$store.state.pages[e].selectedImage>-1&&(this.selected[this.$store.state.pages[e].selectedImage]=!0)}},methods:{imgClicked:function(e){this.selected=[!1,!1,!1,!1],this.selected[e]=!0,this.$store.commit("refreshSelectedImage",{pageNum:this.pageNum,image:e})},generateImages:function(){var e={method:"POST",message:"Successfully generated images",body:v()({prompt:"Generate a kid friendly image of the following sentence: "+this.$store.state.currentSentence,n:4,size:"256x256",response_format:"b64_json"})};this.request(e)},request:function(e){var t=this;return h()(p.a.mark(function s(){var a,n,r,i,o,c;return p.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return a={method:e.method,headers:{"Content-Type":"application/json",Authorization:"Bearer "+Object({NODE_ENV:"production",BASE_URL:"/sparkgen-picture-book/"}).VUE_APP_OPENAI_KEY,"Access-Control-Allow-Origin":"*"}},e.body&&(a.body=e.body),s.prev=2,s.next=5,fetch("https://api.openai.com/v1/images/generations",a);case 5:if((n=s.sent).ok){s.next=11;break}return s.next=9,n.json();case 9:throw r=s.sent,new Error(r.error);case 11:return s.next=13,n.json();case 13:i=s.sent,t.selected=[!1,!1,!1,!1],t.images=i.data.map(function(e){return e.b64_json}),t.$store.commit("refreshGeneratedImages",{pageNum:t.pageNum,images:t.images}),o="Successfully generated images!",t.$store.commit("alert",{message:o,status:"success"}),t.loading=!1,s.next=26;break;case 22:s.prev=22,s.t0=s.catch(2),c="There was an error fetching images",t.$store.commit("alert",{message:c,status:"error"});case 26:case"end":return s.stop()}},s,t,[[2,22]])}))()}}},P={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",[0===this.images.length?s("div",[s("section",{staticClass:"box-container"},[e.loading?s("p",{staticClass:"centered"},[e._v("Loading...\n            ")]):e._e(),e._v(" "),e._m(0),e._v(" "),e._m(1),e._v(" "),e._m(2),e._v(" "),e._m(3)])]):e._e(),e._v(" "),this.images.length>0?s("div",[s("section",{staticClass:"box-container"},[e.loading?s("p",{staticClass:"centered"},[e._v("Loading...\n            ")]):e._e(),e._v(" "),s("section",{staticClass:"box"},[s("img",{staticClass:"box regular-image",style:{"box-shadow":e.selected[0]?"0px 0px 10px 10px yellow":""},attrs:{src:"data:image/jpeg;base64,"+e.images[0]},on:{click:function(t){return e.imgClicked(0)}}})]),e._v(" "),s("section",{staticClass:"box"},[s("img",{staticClass:"box regular-image",style:{"box-shadow":e.selected[1]?"0px 0px 10px 10px yellow":""},attrs:{src:"data:image/jpeg;base64,"+e.images[1]},on:{click:function(t){return e.imgClicked(1)}}})]),e._v(" "),s("section",{staticClass:"box"},[s("img",{staticClass:"box regular-image",style:{"box-shadow":e.selected[2]?"0px 0px 10px 10px yellow":""},attrs:{src:"data:image/jpeg;base64,"+e.images[2]},on:{click:function(t){return e.imgClicked(2)}}})]),e._v(" "),s("section",{staticClass:"box"},[s("img",{staticClass:"box regular-image",style:{"box-shadow":e.selected[3]?"0px 0px 10px 10px yellow":""},attrs:{src:"data:image/jpeg;base64,"+e.images[3]},on:{click:function(t){return e.imgClicked(3)}}})])])]):e._e()])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"empty-box"},[t("p",{staticClass:"box-text"},[this._v("No image generated")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"empty-box"},[t("p",{staticClass:"box-text"},[this._v("No image generated")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"empty-box"},[t("p",{staticClass:"box-text"},[this._v("No image generated")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"empty-box"},[t("p",{staticClass:"box-text"},[this._v("No image generated")])])}]};var S=s("VU/8")(N,P,!1,function(e){s("40b6")},"data-v-67c2ea6a",null).exports,T=s("8FmL"),k={name:"PagePdfTemplate",props:{pageNumber:{type:Number,required:!0},selectedImage:{type:Number,required:!0}}},w={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",{staticClass:"page"},[e.selectedImage>-1?s("div",{staticClass:"picture-box"},[s("img",{staticClass:"picture-box regular-image",attrs:{src:"data:image/jpeg;base64,"+e.$store.state.pages[e.pageNumber].allImages[e.$store.state.pages[e.pageNumber].selectedImage]}})]):e._e(),e._v(" "),s("h1",{staticClass:"box-text"},[e._v("\n        "+e._s(e.$store.state.pages[e.pageNumber].caption)+"\n    ")])])},staticRenderFns:[]};var E=s("VU/8")(k,w,!1,function(e){s("bz4o")},"data-v-aacf7dc0",null).exports,I={render:function(){var e=this.$createElement,t=this._self._c||e;return t("section",{staticClass:"page"},[t("h1",{staticClass:"title-page"},[this._v(this._s(this.$store.state.currentTitle))])])},staticRenderFns:[]};var j=s("VU/8")({name:"TitlePageTemplate"},I,!1,function(e){s("6bff")},"data-v-154e880c",null).exports,A={name:"ExportButton",components:{VueHtml2pdf:T.a,PagePdfTemplate:E,TitlePageTemplate:j},props:{pageNumber:{type:Number,required:!0}},mounted:function(){document.getElementById("pdf-converter").html2Pdf={html2canvas:{useCORS:!0}}},methods:{exportPdf:function(){this.$refs.html2Pdf.generatePdf()}}},F={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",[s("button",{staticClass:"button-74",on:{click:e.exportPdf}},[e._v("\n        Export to PDF\n    ")]),e._v(" "),s("vue-html2pdf",{ref:"html2Pdf",attrs:{id:"pdf-converter","show-layout":!1,"float-layout":!0,"enable-download":!0,"preview-modal":!0,"paginate-elements-by-height":1122,filename:"picture-book","pdf-quality":2,"manual-pagination":!1,"pdf-format":"a4","pdf-margin":10,"pdf-orientation":"portrait","pdf-content-width":"800px"}},[s("section",{attrs:{slot:"pdf-content"},slot:"pdf-content"},[s("TitlePageTemplate"),e._v(" "),e._l(Object.keys(e.$store.state.pages).length,function(t){return s("div",{key:t,attrs:{id:e.pageNumber}},[s("PagePdfTemplate",{attrs:{pageNumber:t,selectedImage:e.$store.state.pages[t].selectedImage}})],1)})],2)])],1)},staticRenderFns:[]},O={name:"HomePage",components:{TitleForm:g,SentenceForm:x,PageComponent:y,PictureDisplay:S,ExportButton:s("VU/8")(A,F,!1,null,null,null).exports},data:function(){return{editing:!1,currentPage:r()(this.$store.state.pages).length,previousSentence:"",refreshGenerated:{pageNum:1,sentence:"This is a story about "+this.$store.state.currentTitle},changeCount:0}},methods:{finishPage:function(){if(this.$store.state.pages[this.currentPage].selectedImage>-1){this.$store.commit("editPage",this.currentPage),this.currentPage===r()(this.$store.state.pages).length&&this.$store.commit("createPage"),this.editing=!1,this.currentPage=r()(this.$store.state.pages).length;this.$store.commit("alert",{message:"Page has been successfully saved.",status:"success"})}else{this.$store.commit("alert",{message:"No image has been selected",status:"error"})}},getPage:function(e){var t=this.$store.state.pages[e];this.currentPage=e,this.$store.commit("changeSentence",{pageNum:this.currentPage,sentence:t.caption}),this.editing=!0},sendNotificationToGeneration:function(e){this.changeCount+=1}}},U={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("article",[""!==e.$store.state.currentTitle?s("ExportButton",{staticClass:"export-button",attrs:{pageNumber:e.currentPage}}):e._e(),e._v(" "),""===e.$store.state.currentTitle?s("section",{staticClass:"title-section"},[e.$store.state.username?s("h2",[e._v("\n      Welcome "+e._s(e.$store.state.username)+"\n      ")]):e._e(),e._v(" "),e.$store.state.username?s("h2",[e._v("\n        Add a title to begin a new story!\n      ")]):e._e(),e._v(" "),e.$store.state.username?e._e():s("h2",[e._v("\n        Enter in your username\n      ")]),e._v(" "),s("TitleForm")],1):e._e(),e._v(" "),""!==e.$store.state.currentTitle?s("section",{staticClass:"container"},[s("div",{staticClass:"top-of-page"},[s("TitleForm"),e._v(" "),s("h1",[e._v("Currently editing page "+e._s(e.currentPage))]),e._v(" "),s("PictureDisplay",{staticClass:"picture-display",attrs:{pageNum:e.currentPage,changeCount:e.changeCount}})],1),e._v(" "),s("section",[s("SentenceForm",{staticClass:"sentence-form",attrs:{pageNum:e.currentPage},on:{sentenceEdited:e.sendNotificationToGeneration}}),e._v(" "),s("button",{staticClass:"finish-button button-74",on:{click:e.finishPage}},[e._v("Save Page\n      ")])],1),e._v(" "),""!==e.$store.state.currentTitle?s("div",{staticClass:"page-component"},e._l(Object.keys(e.$store.state.pages).length,function(t){return s("PageComponent",{key:t,attrs:{pageNumber:t,active:t===e.currentPage,selectedImage:e.$store.state.pages[t].selectedImage},on:{boxClicked:e.getPage}})}),1):e._e()]):e._e(),e._v(" "),s("section",{staticClass:"alerts"},e._l(e.$store.state.alerts,function(t,a,n){return s("article",{key:n,class:t},[s("p",[e._v(e._s(a))])])}),0)],1)},staticRenderFns:[]};var q=s("VU/8")(O,U,!1,function(e){s("4VNO")},"data-v-4c261611",null).exports;a.a.use(u.a);var V=new u.a({routes:[{path:"/",name:"HomePage",component:q}]}),z=s("NYxO"),R=s("424j"),B=s("Zrlr"),D=s.n(B),G=function e(){D()(this,e),this.picture="",this.caption="",this.previousSentence="",this.generatedSentences=[],this.allImages=[],this.selectedImage=-1};a.a.use(z.a);var H=new z.a.Store({state:{username:"",currentTitle:"",pages:{},currentSentence:"",alerts:{}},mutations:{alert:function(e,t){a.a.set(e.alerts,t.message,t.status),setTimeout(function(){a.a.delete(e.alerts,t.message)},3e3)},changeTitle:function(e,t){e.currentTitle=t},addUsername:function(e,t){e.username=t},changeSentence:function(e,t){e.currentSentence=t.sentence,t.sentence&&(e.pages[t.pageNum].caption=t.sentence)},editPage:function(e,t){var s="This is a story about "+e.currentTitle;if(t in e.pages){t-1>=1&&(s=e.pages[t-1].caption);var a=e.pages[t];a.caption=e.currentSentence,a.previousSentence=s,e.pages[t]=a,e.currentSentence=e.pages[r()(e.pages).length].currentSentence?e.pages[r()(e.pages).length].currentSentence:""}},createPage:function(e){e.currentTitle;r()(e.pages).length-1>=1&&e.pages[r()(e.pages).length-1].caption;var t=new G;t.caption="",t.previousSentence="",e.pages[r()(e.pages).length+1]=t,e.currentSentence=""},refreshGeneratedSentence:function(e,t){e.pages[t.pageNum].generatedSentences=t.sentences},refreshGeneratedImages:function(e,t){e.pages[t.pageNum].allImages=t.images},refreshSelectedImage:function(e,t){e.pages[t.pageNum].selectedImage=t.image}},plugins:[Object(R.a)({storage:window.sessionStorage})]});a.a.config.productionTip=!1,new a.a({el:"#app",router:V,store:H,components:{App:c},template:"<App/>"})},aHjL:function(e,t){},bz4o:function(e,t){},"u/Tk":function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.2115ce338f8b9f1cb27d.js.map